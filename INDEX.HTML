<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Sistema de Atendimento – Design Aqua</title>

<style>

:root {
    --bg: #e7f4ff;
    --card: #ffffff;
    --radius: 14px;

    --btn1: #009ffd;
    --btn1-hover: #0077c2;

    --painel-bg: #0d1b2a;
    --painel-text: #00f7ff;

    --sp: #d90429;
    --se: #0066ff;
    --sg: #8f00ff;

    --text: #1a1a1a;
    --title: #003049;
}

body {
    font-family: "Inter", Arial, sans-serif;
    background: var(--bg);
    margin: 0;
    padding: 20px;
    color: var(--text);
}

h1 {
    font-size: 28px;
    margin-bottom: 25px;
    color: var(--title);
    font-weight: 700;
}

h2, h3 {
    margin-bottom: 15px;
    color: var(--title);
}

.container {
    display: flex;
    gap: 25px;
    flex-wrap: wrap;
}

.box {
    background: var(--card);
    padding: 22px;
    width: 30%;
    min-width: 330px;
    border-radius: var(--radius);
    box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    border-left: 6px solid #009ffd;
    transition: 0.25s ease;
}

.box:hover {
    transform: translateY(-4px);
    box-shadow: 0 15px 35px rgba(0,0,0,0.25);
}

button {
    width: 100%;
    padding: 12px;
    margin-top: 8px;
    font-size: 16px;
    border-radius: var(--radius);
    border: none;
    cursor: pointer;
    background: linear-gradient(130deg, #009ffd, #00c2ff);
    color: #fff;
    font-weight: 600;
    transition: 0.3s ease;
}

button:hover {
    background: linear-gradient(130deg, #007acc, #0097d0);
    transform: scale(1.03);
}

.painel-senha {
    background: var(--painel-bg);
    color: var(--painel-text);
    padding: 18px;
    text-align: center;
    font-size: 24px;
    border-radius: var(--radius);
    margin-top: 10px;
    font-family: Consolas, monospace;
    box-shadow: inset 0 0 12px rgba(0,247,255,0.5);
}

ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

ul li {
    padding: 6px 0;
    font-size: 16px;
    border-bottom: 1px solid #e5e5e5;
}

.sp { color: var(--sp); font-weight: bold; }
.se { color: var(--se); font-weight: bold; }
.sg { color: var(--sg); font-weight: bold; }

label, select {
    font-size: 16px;
    color: var(--title);
}

select {
    padding: 6px;
    border-radius: var(--radius);
    border: 1px solid #007acc;
}

</style>
</head>

<body>

<h1>Sistema de Atendimento – Design Aqua</h1>

<div class="container">

    <!-- TOTEM -->
    <div class="box">
        <h2>Totem – Emissão de Senhas</h2>

        <button onclick="emitirSenha('SP')">SP – Prioritária</button>
        <button onclick="emitirSenha('SE')">SE – Exames</button>
        <button onclick="emitirSenha('SG')">SG – Geral</button>

        <div id="ultimaSenha"></div>
        <div id="tempoEstimado"></div>
    </div>

    <!-- ATENDENTE -->
    <div class="box">
        <h2>Atendente – Chamar Próximo</h2>

        <label>Guichê:</label>
        <select id="guiche">
            <option value="1">Guichê 1</option>
            <option value="2">Guichê 2</option>
        </select>

        <button onclick="chamarProximo()">Chamar Próximo</button>

        <div id="chamadaAtendente"></div>

        <h3>Últimas 5 chamadas:</h3>
        <ul id="listaUltimas"></ul>
    </div>

    <!-- PAINEL -->
    <div class="box">
        <h2>Painel</h2>

        <div class="painel-senha" id="painelDisplay">
            Aguardando chamada...
        </div>

        <h3>Últimas 5 chamadas:</h3>
        <ul id="listaUltimasPainel"></ul>
    </div>

</div>

<script>
// FILAS
let filaSP = [];
let filaSE = [];
let filaSG = [];

let tempos = {};
let contador = { SP:0, SE:0, SG:0 };
let proximoTipo = "SP";

let guiches = [1,2];
let indiceGuiche = 0;

let ultimasChamadas = [];
let ultimasChamadasPainel = [];

// GUICHÊ
function proximoGuiche() {
    let g = guiches[indiceGuiche];
    indiceGuiche = (indiceGuiche + 1) % guiches.length;
    return g;
}

// TEMPO
function gerarTM(tipo) {
    if(tipo==="SP" || tipo==="SE") return Math.random() <= 0.95 ? 1 : 5;
    if(tipo==="SG") return Math.floor(Math.random()*7);
}

// EMITIR SENHA
function emitirSenha(tipo) {

    contador[tipo]++;
    let senha = `${tipo}-${contador[tipo]}`;

    if(tipo==="SP") filaSP.push(senha);
    if(tipo==="SE") filaSE.push(senha);
    if(tipo==="SG") filaSG.push(senha);

    tempos[senha] = gerarTM(tipo);

    let guiche = proximoGuiche();

    document.getElementById("ultimaSenha").innerHTML =
    `<p><strong>Sua senha:</strong> ${senha}</p>
     <p><strong>Dirija-se ao Guichê:</strong> ${guiche}</p>`;

    let tempo = calcularTempoEspera(senha);

    document.getElementById("tempoEstimado").innerHTML =
    `<p><strong>Tempo estimado:</strong> ${tempo} min</p>`;
}

// ESTIMATIVA
function calcularTempoEspera(senhaTarget) {

    let sim = {
        SP:[...filaSP],
        SE:[...filaSE],
        SG:[...filaSG]
    };

    let tipo = proximoTipo;
    let total = 0;

    while(true){
        let senha = null;

        if(tipo==="SP"){
            if(sim.SP.length>0){
                senha = sim.SP.shift();
            }
            tipo = "SESG";
        }

        if(!senha && tipo==="SESG"){
            if(sim.SE.length>0) senha = sim.SE.shift();
            else if(sim.SG.length>0) senha = sim.SG.shift();
            tipo = "SP";
        }

        if(!senha) break;

        if(senha === senhaTarget) return total;

        total += tempos[senha];
    }
    return total;
}

// CHAMAR
function chamarProximo() {

    let guiche = document.getElementById("guiche").value;
    let senha = obterProximaSenha();

    if(!senha){
        alert("Nenhuma senha na fila.");
        return;
    }

    document.getElementById("painelDisplay").innerHTML =
    `Senha: <strong>${senha}</strong><br>Guichê: <strong>${guiche}</strong>`;

    document.getElementById("chamadaAtendente").innerHTML =
    `<p><strong>${senha}</strong> chamado ao Guichê <strong>${guiche}</strong>.</p>`;

    ultimasChamadas.unshift({senha, guiche});
    ultimasChamadas = ultimasChamadas.slice(0,5);
    atualizarListaUltimas();

    ultimasChamadasPainel.unshift({senha, guiche});
    ultimasChamadasPainel = ultimasChamadasPainel.slice(0,5);
    atualizarListaPainel();
}

// PRÓXIMA SENHA
function obterProximaSenha() {

    if(proximoTipo==="SP"){
        if(filaSP.length>0){
            proximoTipo="SESG";
            return filaSP.shift();
        }
        proximoTipo="SESG";
    }

    if(proximoTipo==="SESG"){
        if(filaSE.length>0){
            proximoTipo="SP";
            return filaSE.shift();
        }
        if(filaSG.length>0){
            proximoTipo="SP";
            return filaSG.shift();
        }
    }

    return null;
}

// LISTA ATENDENTE
function atualizarListaUltimas() {

    let lista = document.getElementById("listaUltimas");
    lista.innerHTML = "";

    ultimasChamadas.forEach(item=>{
        let li = document.createElement("li");
        li.textContent = `${item.senha} - Guichê ${item.guiche}`;
        lista.appendChild(li);
    });
}

// LISTA PAINEL
function atualizarListaPainel(){

    let lista = document.getElementById("listaUltimasPainel");
    lista.innerHTML = "";

    ultimasChamadasPainel.forEach(item=>{
        let li = document.createElement("li");
        li.textContent = `${item.senha} - Guichê ${item.guiche}`;

        if(item.senha.startsWith("SP")) li.className = "sp";
        if(item.senha.startsWith("SE")) li.className = "se";
        if(item.senha.startsWith("SG")) li.className = "sg";

        lista.appendChild(li);
    });
}

</script>

</body>
</html>
